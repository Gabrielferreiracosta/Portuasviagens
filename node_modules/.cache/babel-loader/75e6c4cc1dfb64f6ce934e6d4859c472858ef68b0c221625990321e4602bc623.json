{"ast":null,"code":"/* instafeed.js | v2.0.0 | https://github.com/stevenschobert/instafeed.js | License: MIT */\n(function (global, factory) {\n  typeof exports === \"object\" && typeof module !== \"undefined\" ? module.exports = factory() : typeof define === \"function\" && define.amd ? define(factory) : (global = typeof globalThis !== \"undefined\" ? globalThis : global || self, global.Instafeed = factory());\n})(this, function () {\n  \"use strict\";\n\n  function assert(val, msg) {\n    if (!val) {\n      throw new Error(msg);\n    }\n  }\n  function Instafeed(options) {\n    assert(!options || typeof options === \"object\", \"options must be an object, got \" + options + \" (\" + typeof options + \")\");\n    var opts = {\n      accessToken: null,\n      accessTokenTimeout: 1e4,\n      after: null,\n      apiTimeout: 1e4,\n      apiLimit: null,\n      before: null,\n      debug: false,\n      error: null,\n      filter: null,\n      limit: null,\n      mock: false,\n      render: null,\n      sort: null,\n      success: null,\n      target: \"instafeed\",\n      template: '<a href=\"{{link}}\"><img title=\"{{caption}}\" src=\"{{image}}\" /></a>',\n      templateBoundaries: [\"{{\", \"}}\"],\n      transform: null\n    };\n    var state = {\n      running: false,\n      node: null,\n      token: null,\n      paging: null,\n      pool: []\n    };\n    if (options) {\n      for (var optKey in opts) {\n        if (typeof options[optKey] !== \"undefined\") {\n          opts[optKey] = options[optKey];\n        }\n      }\n    }\n    assert(typeof opts.target === \"string\" || typeof opts.target === \"object\", \"target must be a string or DOM node, got \" + opts.target + \" (\" + typeof opts.target + \")\");\n    assert(typeof opts.accessToken === \"string\" || typeof opts.accessToken === \"function\", \"accessToken must be a string or function, got \" + opts.accessToken + \" (\" + typeof opts.accessToken + \")\");\n    assert(typeof opts.accessTokenTimeout === \"number\", \"accessTokenTimeout must be a number, got \" + opts.accessTokenTimeout + \" (\" + typeof opts.accessTokenTimeout + \")\");\n    assert(typeof opts.apiTimeout === \"number\", \"apiTimeout must be a number, got \" + opts.apiTimeout + \" (\" + typeof opts.apiTimeout + \")\");\n    assert(typeof opts.debug === \"boolean\", \"debug must be true or false, got \" + opts.debug + \" (\" + typeof opts.debug + \")\");\n    assert(typeof opts.mock === \"boolean\", \"mock must be true or false, got \" + opts.mock + \" (\" + typeof opts.mock + \")\");\n    assert(typeof opts.templateBoundaries === \"object\" && opts.templateBoundaries.length === 2 && typeof opts.templateBoundaries[0] === \"string\" && typeof opts.templateBoundaries[1] === \"string\", \"templateBoundaries must be an array of 2 strings, got \" + opts.templateBoundaries + \" (\" + typeof opts.templateBoundaries + \")\");\n    assert(!opts.template || typeof opts.template === \"string\", \"template must null or string, got \" + opts.template + \" (\" + typeof opts.template + \")\");\n    assert(!opts.error || typeof opts.error === \"function\", \"error must be null or function, got \" + opts.error + \" (\" + typeof opts.error + \")\");\n    assert(!opts.before || typeof opts.before === \"function\", \"before must be null or function, got \" + opts.before + \" (\" + typeof opts.before + \")\");\n    assert(!opts.after || typeof opts.after === \"function\", \"after must be null or function, got \" + opts.after + \" (\" + typeof opts.after + \")\");\n    assert(!opts.success || typeof opts.success === \"function\", \"success must be null or function, got \" + opts.success + \" (\" + typeof opts.success + \")\");\n    assert(!opts.filter || typeof opts.filter === \"function\", \"filter must be null or function, got \" + opts.filter + \" (\" + typeof opts.filter + \")\");\n    assert(!opts.transform || typeof opts.transform === \"function\", \"transform must be null or function, got \" + opts.transform + \" (\" + typeof opts.transform + \")\");\n    assert(!opts.sort || typeof opts.sort === \"function\", \"sort must be null or function, got \" + opts.sort + \" (\" + typeof opts.sort + \")\");\n    assert(!opts.render || typeof opts.render === \"function\", \"render must be null or function, got \" + opts.render + \" (\" + typeof opts.render + \")\");\n    assert(!opts.limit || typeof opts.limit === \"number\", \"limit must be null or number, got \" + opts.limit + \" (\" + typeof opts.limit + \")\");\n    assert(!opts.apiLimit || typeof opts.apiLimit === \"number\", \"apiLimit must null or number, got \" + opts.apiLimit + \" (\" + typeof opts.apiLimit + \")\");\n    this._state = state;\n    this._options = opts;\n  }\n  Instafeed.prototype.run = function run() {\n    var scope = this;\n    this._debug(\"run\", \"options\", this._options);\n    this._debug(\"run\", \"state\", this._state);\n    if (this._state.running) {\n      this._debug(\"run\", \"already running, skipping\");\n      return false;\n    }\n    this._start();\n    this._debug(\"run\", \"getting dom node\");\n    if (typeof this._options.target === \"string\") {\n      this._state.node = document.getElementById(this._options.target);\n    } else {\n      this._state.node = this._options.target;\n    }\n    if (!this._state.node) {\n      this._fail(new Error(\"no element found with ID \" + this._options.target));\n      return false;\n    }\n    this._debug(\"run\", \"got dom node\", this._state.node);\n    this._debug(\"run\", \"getting access token\");\n    this._getAccessToken(function onTokenReceived(err, token) {\n      if (err) {\n        scope._debug(\"onTokenReceived\", \"error\", err);\n        scope._fail(new Error(\"error getting access token: \" + err.message));\n        return;\n      }\n      scope._debug(\"onTokenReceived\", \"got token\", token);\n      scope._state.token = token;\n      scope._showNext(function onNextShown(err) {\n        if (err) {\n          scope._debug(\"onNextShown\", \"error\", err);\n          scope._fail(err);\n          return;\n        }\n        scope._finish();\n      });\n    });\n    return true;\n  };\n  Instafeed.prototype.hasNext = function hasNext() {\n    var paging = this._state.paging;\n    var pool = this._state.pool;\n    this._debug(\"hasNext\", \"paging\", paging);\n    this._debug(\"hasNext\", \"pool\", pool.length, pool);\n    return pool.length > 0 || paging && typeof paging.next === \"string\";\n  };\n  Instafeed.prototype.next = function next() {\n    var scope = this;\n    if (!scope.hasNext()) {\n      scope._debug(\"next\", \"hasNext is false, skipping\");\n      return false;\n    }\n    if (scope._state.running) {\n      scope._debug(\"next\", \"already running, skipping\");\n      return false;\n    }\n    scope._start();\n    scope._showNext(function onNextShown(err) {\n      if (err) {\n        scope._debug(\"onNextShown\", \"error\", err);\n        scope._fail(err);\n        return;\n      }\n      scope._finish();\n    });\n  };\n  Instafeed.prototype._showNext = function showNext(callback) {\n    var scope = this;\n    var url = null;\n    var poolItems = null;\n    var hasLimit = typeof this._options.limit === \"number\";\n    scope._debug(\"showNext\", \"pool\", scope._state.pool.length, scope._state.pool);\n    if (scope._state.pool.length > 0) {\n      if (hasLimit) {\n        poolItems = scope._state.pool.splice(0, scope._options.limit);\n      } else {\n        poolItems = scope._state.pool.splice(0);\n      }\n      scope._debug(\"showNext\", \"items from pool\", poolItems.length, poolItems);\n      scope._debug(\"showNext\", \"updated pool\", scope._state.pool.length, scope._state.pool);\n      if (scope._options.mock) {\n        scope._debug(\"showNext\", \"mock enabled, skipping render\");\n      } else {\n        try {\n          scope._renderData(poolItems);\n        } catch (renderErr) {\n          callback(renderErr);\n          return;\n        }\n      }\n      callback(null);\n    } else {\n      if (scope._state.paging && typeof scope._state.paging.next === \"string\") {\n        url = scope._state.paging.next;\n      } else {\n        url = \"https://graph.instagram.com/me/media?fields=caption,id,media_type,media_url,permalink,thumbnail_url,timestamp,username&access_token=\" + scope._state.token;\n        if (!scope._options.apiLimit && typeof scope._options.limit === \"number\") {\n          scope._debug(\"showNext\", \"no apiLimit set, falling back to limit\", scope._options.apiLimit, scope._options.limit);\n          url = url + \"&limit=\" + scope._options.limit;\n        } else if (typeof scope._options.apiLimit === \"number\") {\n          scope._debug(\"showNext\", \"apiLimit set, overriding limit\", scope._options.apiLimit, scope._options.limit);\n          url = url + \"&limit=\" + scope._options.apiLimit;\n        }\n      }\n      scope._debug(\"showNext\", \"making request\", url);\n      scope._makeApiRequest(url, function onResponseReceived(err, data) {\n        var processed = null;\n        if (err) {\n          scope._debug(\"onResponseReceived\", \"error\", err);\n          callback(new Error(\"api request error: \" + err.message));\n          return;\n        }\n        scope._debug(\"onResponseReceived\", \"data\", data);\n        scope._success(data);\n        scope._debug(\"onResponseReceived\", \"setting paging\", data.paging);\n        scope._state.paging = data.paging;\n        try {\n          processed = scope._processData(data);\n          scope._debug(\"onResponseReceived\", \"processed data\", processed);\n          if (processed.unused && processed.unused.length > 0) {\n            scope._debug(\"onResponseReceived\", \"saving unused to pool\", processed.unused.length, processed.unused);\n            for (var i = 0; i < processed.unused.length; i++) {\n              scope._state.pool.push(processed.unused[i]);\n            }\n          }\n        } catch (processErr) {\n          callback(processErr);\n          return;\n        }\n        if (scope._options.mock) {\n          scope._debug(\"onResponseReceived\", \"mock enabled, skipping append\");\n        } else {\n          try {\n            scope._renderData(processed.items);\n          } catch (renderErr) {\n            callback(renderErr);\n            return;\n          }\n        }\n        callback(null);\n      });\n    }\n  };\n  Instafeed.prototype._processData = function processData(data) {\n    var hasTransform = typeof this._options.transform === \"function\";\n    var hasFilter = typeof this._options.filter === \"function\";\n    var hasSort = typeof this._options.sort === \"function\";\n    var hasLimit = typeof this._options.limit === \"number\";\n    var transformedFiltered = [];\n    var limitDelta = null;\n    var dataItem = null;\n    var transformedItem = null;\n    var filterResult = null;\n    var unusedItems = null;\n    this._debug(\"processData\", \"hasFilter\", hasFilter, \"hasTransform\", hasTransform, \"hasSort\", hasSort, \"hasLimit\", hasLimit);\n    if (typeof data !== \"object\" || typeof data.data !== \"object\" || data.data.length <= 0) {\n      return null;\n    }\n    for (var i = 0; i < data.data.length; i++) {\n      dataItem = this._getItemData(data.data[i]);\n      if (hasTransform) {\n        try {\n          transformedItem = this._options.transform(dataItem);\n          this._debug(\"processData\", \"transformed item\", dataItem, transformedItem);\n        } catch (err) {\n          this._debug(\"processData\", \"error calling transform\", err);\n          throw new Error(\"error in transform: \" + err.message);\n        }\n      } else {\n        transformedItem = dataItem;\n      }\n      if (hasFilter) {\n        try {\n          filterResult = this._options.filter(transformedItem);\n          this._debug(\"processData\", \"filter item result\", transformedItem, filterResult);\n        } catch (err) {\n          this._debug(\"processData\", \"error calling filter\", err);\n          throw new Error(\"error in filter: \" + err.message);\n        }\n        if (filterResult) {\n          transformedFiltered.push(transformedItem);\n        }\n      } else {\n        transformedFiltered.push(transformedItem);\n      }\n    }\n    if (hasSort) {\n      try {\n        transformedFiltered.sort(this._options.sort);\n      } catch (err) {\n        this._debug(\"processData\", \"error calling sort\", err);\n        throw new Error(\"error in sort: \" + err.message);\n      }\n    }\n    if (hasLimit) {\n      limitDelta = transformedFiltered.length - this._options.limit;\n      this._debug(\"processData\", \"checking limit\", transformedFiltered.length, this._options.limit, limitDelta);\n      if (limitDelta > 0) {\n        unusedItems = transformedFiltered.slice(transformedFiltered.length - limitDelta);\n        this._debug(\"processData\", \"unusedItems\", unusedItems.length, unusedItems);\n        transformedFiltered.splice(transformedFiltered.length - limitDelta, limitDelta);\n      }\n    }\n    return {\n      items: transformedFiltered,\n      unused: unusedItems\n    };\n  };\n  Instafeed.prototype._extractTags = function extractTags(str) {\n    var exp = /#([^\\s]+)/gi;\n    var badChars = /[~`!@#$%^&*\\(\\)\\-+={}[\\]:;\"'<>?,./|\\\\\\s]+/i;\n    var tags = [];\n    var match = null;\n    if (typeof str === \"string\") {\n      while ((match = exp.exec(str)) !== null) {\n        if (badChars.test(match[1]) === false) {\n          tags.push(match[1]);\n        }\n      }\n    }\n    return tags;\n  };\n  Instafeed.prototype._getItemData = function getItemData(data) {\n    var type = null;\n    var image = null;\n    switch (data.media_type) {\n      case \"IMAGE\":\n        type = \"image\";\n        image = data.media_url;\n        break;\n      case \"VIDEO\":\n        type = \"video\";\n        image = data.thumbnail_url;\n        break;\n      case \"CAROUSEL_ALBUM\":\n        type = \"album\";\n        image = data.media_url;\n        break;\n    }\n    return {\n      caption: data.caption,\n      tags: this._extractTags(data.caption),\n      id: data.id,\n      image: image,\n      link: data.permalink,\n      model: data,\n      timestamp: data.timestamp,\n      type: type,\n      username: data.username\n    };\n  };\n  Instafeed.prototype._renderData = function renderData(items) {\n    var hasTemplate = typeof this._options.template === \"string\";\n    var hasRender = typeof this._options.render === \"function\";\n    var item = null;\n    var itemHtml = null;\n    var container = null;\n    var html = \"\";\n    this._debug(\"renderData\", \"hasTemplate\", hasTemplate, \"hasRender\", hasRender);\n    if (typeof items !== \"object\" || items.length <= 0) {\n      return;\n    }\n    for (var i = 0; i < items.length; i++) {\n      item = items[i];\n      if (hasRender) {\n        try {\n          itemHtml = this._options.render(item, this._options);\n          this._debug(\"renderData\", \"custom render result\", item, itemHtml);\n        } catch (err) {\n          this._debug(\"renderData\", \"error calling render\", err);\n          throw new Error(\"error in render: \" + err.message);\n        }\n      } else if (hasTemplate) {\n        itemHtml = this._basicRender(item);\n      }\n      if (itemHtml) {\n        html = html + itemHtml;\n      } else {\n        this._debug(\"renderData\", \"render item did not return any content\", item);\n      }\n    }\n    this._debug(\"renderData\", \"html content\", html);\n    container = document.createElement(\"div\");\n    container.innerHTML = html;\n    this._debug(\"renderData\", \"container\", container, container.childNodes.length, container.childNodes);\n    while (container.childNodes.length > 0) {\n      this._debug(\"renderData\", \"appending child\", container.childNodes[0]);\n      this._state.node.appendChild(container.childNodes[0]);\n    }\n  };\n  Instafeed.prototype._basicRender = function basicRender(data) {\n    var exp = new RegExp(this._options.templateBoundaries[0] + \"([\\\\s\\\\w.]+)\" + this._options.templateBoundaries[1], \"gm\");\n    var template = this._options.template;\n    var match = null;\n    var output = \"\";\n    var substr = null;\n    var lastIndex = 0;\n    var keyPath = null;\n    var keyPathValue = null;\n    while ((match = exp.exec(template)) !== null) {\n      keyPath = match[1];\n      substr = template.slice(lastIndex, match.index);\n      output = output + substr;\n      keyPathValue = this._valueForKeyPath(keyPath, data);\n      if (keyPathValue) {\n        output = output + keyPathValue.toString();\n      }\n      lastIndex = exp.lastIndex;\n    }\n    if (lastIndex < template.length) {\n      substr = template.slice(lastIndex, template.length);\n      output = output + substr;\n    }\n    return output;\n  };\n  Instafeed.prototype._valueForKeyPath = function valueForKeyPath(keyPath, data) {\n    var exp = /([\\w]+)/gm;\n    var match = null;\n    var key = null;\n    var lastValue = data;\n    while ((match = exp.exec(keyPath)) !== null) {\n      if (typeof lastValue !== \"object\") {\n        return null;\n      }\n      key = match[1];\n      lastValue = lastValue[key];\n    }\n    return lastValue;\n  };\n  Instafeed.prototype._fail = function fail(err) {\n    var didHook = this._runHook(\"error\", err);\n    if (!didHook && console && typeof console.error === \"function\") {\n      console.error(err);\n    }\n    this._state.running = false;\n  };\n  Instafeed.prototype._start = function start() {\n    this._state.running = true;\n    this._runHook(\"before\");\n  };\n  Instafeed.prototype._finish = function finish() {\n    this._runHook(\"after\");\n    this._state.running = false;\n  };\n  Instafeed.prototype._success = function success(data) {\n    this._runHook(\"success\", data);\n    this._state.running = false;\n  };\n  Instafeed.prototype._makeApiRequest = function makeApiRequest(url, callback) {\n    var called = false;\n    var scope = this;\n    var apiRequest = null;\n    var callbackOnce = function callbackOnce(err, value) {\n      if (!called) {\n        called = true;\n        callback(err, value);\n      }\n    };\n    apiRequest = new XMLHttpRequest();\n    apiRequest.ontimeout = function apiRequestTimedOut() {\n      callbackOnce(new Error(\"api request timed out\"));\n    };\n    apiRequest.onerror = function apiRequestOnError() {\n      callbackOnce(new Error(\"api connection error\"));\n    };\n    apiRequest.onload = function apiRequestOnLoad(event) {\n      var contentType = apiRequest.getResponseHeader(\"Content-Type\");\n      var responseJson = null;\n      scope._debug(\"apiRequestOnLoad\", \"loaded\", event);\n      scope._debug(\"apiRequestOnLoad\", \"response status\", apiRequest.status);\n      scope._debug(\"apiRequestOnLoad\", \"response content type\", contentType);\n      if (contentType.indexOf(\"application/json\") >= 0) {\n        try {\n          responseJson = JSON.parse(apiRequest.responseText);\n        } catch (err) {\n          scope._debug(\"apiRequestOnLoad\", \"json parsing error\", err, apiRequest.responseText);\n          callbackOnce(new Error(\"error parsing response json\"));\n          return;\n        }\n      }\n      if (apiRequest.status !== 200) {\n        if (responseJson && responseJson.error) {\n          callbackOnce(new Error(responseJson.error.code + \" \" + responseJson.error.message));\n        } else {\n          callbackOnce(new Error(\"status code \" + apiRequest.status));\n        }\n        return;\n      }\n      callbackOnce(null, responseJson);\n    };\n    apiRequest.open(\"GET\", url, true);\n    apiRequest.timeout = this._options.apiTimeout;\n    apiRequest.send();\n  };\n  Instafeed.prototype._getAccessToken = function getAccessToken(callback) {\n    var called = false;\n    var scope = this;\n    var timeoutCheck = null;\n    var callbackOnce = function callbackOnce(err, value) {\n      if (!called) {\n        called = true;\n        clearTimeout(timeoutCheck);\n        callback(err, value);\n      }\n    };\n    if (typeof this._options.accessToken === \"function\") {\n      this._debug(\"getAccessToken\", \"calling accessToken as function\");\n      timeoutCheck = setTimeout(function accessTokenTimeoutCheck() {\n        scope._debug(\"getAccessToken\", \"timeout check\", called);\n        callbackOnce(new Error(\"accessToken timed out\"), null);\n      }, this._options.accessTokenTimeout);\n      try {\n        this._options.accessToken(function accessTokenReceiver(err, value) {\n          scope._debug(\"getAccessToken\", \"received accessToken callback\", called, err, value);\n          callbackOnce(err, value);\n        });\n      } catch (err) {\n        this._debug(\"getAccessToken\", \"error invoking the accessToken as function\", err);\n        callbackOnce(err, null);\n      }\n    } else {\n      this._debug(\"getAccessToken\", \"treating accessToken as static\", typeof this._options.accessToken);\n      callbackOnce(null, this._options.accessToken);\n    }\n  };\n  Instafeed.prototype._debug = function debug() {\n    var args = null;\n    if (this._options.debug && console && typeof console.log === \"function\") {\n      args = [].slice.call(arguments);\n      args[0] = \"[Instafeed] [\" + args[0] + \"]\";\n      console.log.apply(null, args);\n    }\n  };\n  Instafeed.prototype._runHook = function runHook(hookName, data) {\n    var success = false;\n    if (typeof this._options[hookName] === \"function\") {\n      try {\n        this._options[hookName](data);\n        success = true;\n      } catch (err) {\n        this._debug(\"runHook\", \"error calling hook\", hookName, err);\n      }\n    }\n    return success;\n  };\n  return Instafeed;\n});","map":{"version":3,"names":["global","factory","exports","module","define","amd","globalThis","self","Instafeed","assert","val","msg","Error","options","opts","accessToken","accessTokenTimeout","after","apiTimeout","apiLimit","before","debug","error","filter","limit","mock","render","sort","success","target","template","templateBoundaries","transform","state","running","node","token","paging","pool","optKey","length","_state","_options","prototype","run","scope","_debug","_start","document","getElementById","_fail","_getAccessToken","onTokenReceived","err","message","_showNext","onNextShown","_finish","hasNext","next","showNext","callback","url","poolItems","hasLimit","splice","_renderData","renderErr","_makeApiRequest","onResponseReceived","data","processed","_success","_processData","unused","i","push","processErr","items","processData","hasTransform","hasFilter","hasSort","transformedFiltered","limitDelta","dataItem","transformedItem","filterResult","unusedItems","_getItemData","slice","_extractTags","extractTags","str","exp","badChars","tags","match","exec","test","getItemData","type","image","media_type","media_url","thumbnail_url","caption","id","link","permalink","model","timestamp","username","renderData","hasTemplate","hasRender","item","itemHtml","container","html","_basicRender","createElement","innerHTML","childNodes","appendChild","basicRender","RegExp","output","substr","lastIndex","keyPath","keyPathValue","index","_valueForKeyPath","toString","valueForKeyPath","key","lastValue","fail","didHook","_runHook","console","start","finish","makeApiRequest","called","apiRequest","callbackOnce","value","XMLHttpRequest","ontimeout","apiRequestTimedOut","onerror","apiRequestOnError","onload","apiRequestOnLoad","event","contentType","getResponseHeader","responseJson","status","indexOf","JSON","parse","responseText","code","open","timeout","send","getAccessToken","timeoutCheck","clearTimeout","setTimeout","accessTokenTimeoutCheck","accessTokenReceiver","args","log","call","arguments","apply","runHook","hookName"],"sources":["C:/www/portuasviagens/src/instafeeds/instafeed.js"],"sourcesContent":["/* instafeed.js | v2.0.0 | https://github.com/stevenschobert/instafeed.js | License: MIT */\r\n(function(global, factory) {\r\n    typeof exports === \"object\" && typeof module !== \"undefined\" ? module.exports = factory() : typeof define === \"function\" && define.amd ? define(factory) : (global = typeof globalThis !== \"undefined\" ? globalThis : global || self, \r\n    global.Instafeed = factory());\r\n  })(this, function() {\r\n    \"use strict\";\r\n    function assert(val, msg) {\r\n      if (!val) {\r\n        throw new Error(msg);\r\n      }\r\n    }\r\n    function Instafeed(options) {\r\n      assert(!options || typeof options === \"object\", \"options must be an object, got \" + options + \" (\" + typeof options + \")\");\r\n      var opts = {\r\n        accessToken: null,\r\n        accessTokenTimeout: 1e4,\r\n        after: null,\r\n        apiTimeout: 1e4,\r\n        apiLimit: null,\r\n        before: null,\r\n        debug: false,\r\n        error: null,\r\n        filter: null,\r\n        limit: null,\r\n        mock: false,\r\n        render: null,\r\n        sort: null,\r\n        success: null,\r\n        target: \"instafeed\",\r\n        template: '<a href=\"{{link}}\"><img title=\"{{caption}}\" src=\"{{image}}\" /></a>',\r\n        templateBoundaries: [ \"{{\", \"}}\" ],\r\n        transform: null\r\n      };\r\n      var state = {\r\n        running: false,\r\n        node: null,\r\n        token: null,\r\n        paging: null,\r\n        pool: []\r\n      };\r\n      if (options) {\r\n        for (var optKey in opts) {\r\n          if (typeof options[optKey] !== \"undefined\") {\r\n            opts[optKey] = options[optKey];\r\n          }\r\n        }\r\n      }\r\n      assert(typeof opts.target === \"string\" || typeof opts.target === \"object\", \"target must be a string or DOM node, got \" + opts.target + \" (\" + typeof opts.target + \")\");\r\n      assert(typeof opts.accessToken === \"string\" || typeof opts.accessToken === \"function\", \"accessToken must be a string or function, got \" + opts.accessToken + \" (\" + typeof opts.accessToken + \")\");\r\n      assert(typeof opts.accessTokenTimeout === \"number\", \"accessTokenTimeout must be a number, got \" + opts.accessTokenTimeout + \" (\" + typeof opts.accessTokenTimeout + \")\");\r\n      assert(typeof opts.apiTimeout === \"number\", \"apiTimeout must be a number, got \" + opts.apiTimeout + \" (\" + typeof opts.apiTimeout + \")\");\r\n      assert(typeof opts.debug === \"boolean\", \"debug must be true or false, got \" + opts.debug + \" (\" + typeof opts.debug + \")\");\r\n      assert(typeof opts.mock === \"boolean\", \"mock must be true or false, got \" + opts.mock + \" (\" + typeof opts.mock + \")\");\r\n      assert(typeof opts.templateBoundaries === \"object\" && opts.templateBoundaries.length === 2 && typeof opts.templateBoundaries[0] === \"string\" && typeof opts.templateBoundaries[1] === \"string\", \"templateBoundaries must be an array of 2 strings, got \" + opts.templateBoundaries + \" (\" + typeof opts.templateBoundaries + \")\");\r\n      assert(!opts.template || typeof opts.template === \"string\", \"template must null or string, got \" + opts.template + \" (\" + typeof opts.template + \")\");\r\n      assert(!opts.error || typeof opts.error === \"function\", \"error must be null or function, got \" + opts.error + \" (\" + typeof opts.error + \")\");\r\n      assert(!opts.before || typeof opts.before === \"function\", \"before must be null or function, got \" + opts.before + \" (\" + typeof opts.before + \")\");\r\n      assert(!opts.after || typeof opts.after === \"function\", \"after must be null or function, got \" + opts.after + \" (\" + typeof opts.after + \")\");\r\n      assert(!opts.success || typeof opts.success === \"function\", \"success must be null or function, got \" + opts.success + \" (\" + typeof opts.success + \")\");\r\n      assert(!opts.filter || typeof opts.filter === \"function\", \"filter must be null or function, got \" + opts.filter + \" (\" + typeof opts.filter + \")\");\r\n      assert(!opts.transform || typeof opts.transform === \"function\", \"transform must be null or function, got \" + opts.transform + \" (\" + typeof opts.transform + \")\");\r\n      assert(!opts.sort || typeof opts.sort === \"function\", \"sort must be null or function, got \" + opts.sort + \" (\" + typeof opts.sort + \")\");\r\n      assert(!opts.render || typeof opts.render === \"function\", \"render must be null or function, got \" + opts.render + \" (\" + typeof opts.render + \")\");\r\n      assert(!opts.limit || typeof opts.limit === \"number\", \"limit must be null or number, got \" + opts.limit + \" (\" + typeof opts.limit + \")\");\r\n      assert(!opts.apiLimit || typeof opts.apiLimit === \"number\", \"apiLimit must null or number, got \" + opts.apiLimit + \" (\" + typeof opts.apiLimit + \")\");\r\n      this._state = state;\r\n      this._options = opts;\r\n    }\r\n    Instafeed.prototype.run = function run() {\r\n      var scope = this;\r\n      this._debug(\"run\", \"options\", this._options);\r\n      this._debug(\"run\", \"state\", this._state);\r\n      if (this._state.running) {\r\n        this._debug(\"run\", \"already running, skipping\");\r\n        return false;\r\n      }\r\n      this._start();\r\n      this._debug(\"run\", \"getting dom node\");\r\n      if (typeof this._options.target === \"string\") {\r\n        this._state.node = document.getElementById(this._options.target);\r\n      } else {\r\n        this._state.node = this._options.target;\r\n      }\r\n      if (!this._state.node) {\r\n        this._fail(new Error(\"no element found with ID \" + this._options.target));\r\n        return false;\r\n      }\r\n      this._debug(\"run\", \"got dom node\", this._state.node);\r\n      this._debug(\"run\", \"getting access token\");\r\n      this._getAccessToken(function onTokenReceived(err, token) {\r\n        if (err) {\r\n          scope._debug(\"onTokenReceived\", \"error\", err);\r\n          scope._fail(new Error(\"error getting access token: \" + err.message));\r\n          return;\r\n        }\r\n        scope._debug(\"onTokenReceived\", \"got token\", token);\r\n        scope._state.token = token;\r\n        scope._showNext(function onNextShown(err) {\r\n          if (err) {\r\n            scope._debug(\"onNextShown\", \"error\", err);\r\n            scope._fail(err);\r\n            return;\r\n          }\r\n          scope._finish();\r\n        });\r\n      });\r\n      return true;\r\n    };\r\n    Instafeed.prototype.hasNext = function hasNext() {\r\n      var paging = this._state.paging;\r\n      var pool = this._state.pool;\r\n      this._debug(\"hasNext\", \"paging\", paging);\r\n      this._debug(\"hasNext\", \"pool\", pool.length, pool);\r\n      return pool.length > 0 || paging && typeof paging.next === \"string\";\r\n    };\r\n    Instafeed.prototype.next = function next() {\r\n      var scope = this;\r\n      if (!scope.hasNext()) {\r\n        scope._debug(\"next\", \"hasNext is false, skipping\");\r\n        return false;\r\n      }\r\n      if (scope._state.running) {\r\n        scope._debug(\"next\", \"already running, skipping\");\r\n        return false;\r\n      }\r\n      scope._start();\r\n      scope._showNext(function onNextShown(err) {\r\n        if (err) {\r\n          scope._debug(\"onNextShown\", \"error\", err);\r\n          scope._fail(err);\r\n          return;\r\n        }\r\n        scope._finish();\r\n      });\r\n    };\r\n    Instafeed.prototype._showNext = function showNext(callback) {\r\n      var scope = this;\r\n      var url = null;\r\n      var poolItems = null;\r\n      var hasLimit = typeof this._options.limit === \"number\";\r\n      scope._debug(\"showNext\", \"pool\", scope._state.pool.length, scope._state.pool);\r\n      if (scope._state.pool.length > 0) {\r\n        if (hasLimit) {\r\n          poolItems = scope._state.pool.splice(0, scope._options.limit);\r\n        } else {\r\n          poolItems = scope._state.pool.splice(0);\r\n        }\r\n        scope._debug(\"showNext\", \"items from pool\", poolItems.length, poolItems);\r\n        scope._debug(\"showNext\", \"updated pool\", scope._state.pool.length, scope._state.pool);\r\n        if (scope._options.mock) {\r\n          scope._debug(\"showNext\", \"mock enabled, skipping render\");\r\n        } else {\r\n          try {\r\n            scope._renderData(poolItems);\r\n          } catch (renderErr) {\r\n            callback(renderErr);\r\n            return;\r\n          }\r\n        }\r\n        callback(null);\r\n      } else {\r\n        if (scope._state.paging && typeof scope._state.paging.next === \"string\") {\r\n          url = scope._state.paging.next;\r\n        } else {\r\n          url = \"https://graph.instagram.com/me/media?fields=caption,id,media_type,media_url,permalink,thumbnail_url,timestamp,username&access_token=\" + scope._state.token;\r\n          if (!scope._options.apiLimit && typeof scope._options.limit === \"number\") {\r\n            scope._debug(\"showNext\", \"no apiLimit set, falling back to limit\", scope._options.apiLimit, scope._options.limit);\r\n            url = url + \"&limit=\" + scope._options.limit;\r\n          } else if (typeof scope._options.apiLimit === \"number\") {\r\n            scope._debug(\"showNext\", \"apiLimit set, overriding limit\", scope._options.apiLimit, scope._options.limit);\r\n            url = url + \"&limit=\" + scope._options.apiLimit;\r\n          }\r\n        }\r\n        scope._debug(\"showNext\", \"making request\", url);\r\n        scope._makeApiRequest(url, function onResponseReceived(err, data) {\r\n          var processed = null;\r\n          if (err) {\r\n            scope._debug(\"onResponseReceived\", \"error\", err);\r\n            callback(new Error(\"api request error: \" + err.message));\r\n            return;\r\n          }\r\n          scope._debug(\"onResponseReceived\", \"data\", data);\r\n          scope._success(data);\r\n          scope._debug(\"onResponseReceived\", \"setting paging\", data.paging);\r\n          scope._state.paging = data.paging;\r\n          try {\r\n            processed = scope._processData(data);\r\n            scope._debug(\"onResponseReceived\", \"processed data\", processed);\r\n            if (processed.unused && processed.unused.length > 0) {\r\n              scope._debug(\"onResponseReceived\", \"saving unused to pool\", processed.unused.length, processed.unused);\r\n              for (var i = 0; i < processed.unused.length; i++) {\r\n                scope._state.pool.push(processed.unused[i]);\r\n              }\r\n            }\r\n          } catch (processErr) {\r\n            callback(processErr);\r\n            return;\r\n          }\r\n          if (scope._options.mock) {\r\n            scope._debug(\"onResponseReceived\", \"mock enabled, skipping append\");\r\n          } else {\r\n            try {\r\n              scope._renderData(processed.items);\r\n            } catch (renderErr) {\r\n              callback(renderErr);\r\n              return;\r\n            }\r\n          }\r\n          callback(null);\r\n        });\r\n      }\r\n    };\r\n    Instafeed.prototype._processData = function processData(data) {\r\n      var hasTransform = typeof this._options.transform === \"function\";\r\n      var hasFilter = typeof this._options.filter === \"function\";\r\n      var hasSort = typeof this._options.sort === \"function\";\r\n      var hasLimit = typeof this._options.limit === \"number\";\r\n      var transformedFiltered = [];\r\n      var limitDelta = null;\r\n      var dataItem = null;\r\n      var transformedItem = null;\r\n      var filterResult = null;\r\n      var unusedItems = null;\r\n      this._debug(\"processData\", \"hasFilter\", hasFilter, \"hasTransform\", hasTransform, \"hasSort\", hasSort, \"hasLimit\", hasLimit);\r\n      if (typeof data !== \"object\" || typeof data.data !== \"object\" || data.data.length <= 0) {\r\n        return null;\r\n      }\r\n      for (var i = 0; i < data.data.length; i++) {\r\n        dataItem = this._getItemData(data.data[i]);\r\n        if (hasTransform) {\r\n          try {\r\n            transformedItem = this._options.transform(dataItem);\r\n            this._debug(\"processData\", \"transformed item\", dataItem, transformedItem);\r\n          } catch (err) {\r\n            this._debug(\"processData\", \"error calling transform\", err);\r\n            throw new Error(\"error in transform: \" + err.message);\r\n          }\r\n        } else {\r\n          transformedItem = dataItem;\r\n        }\r\n        if (hasFilter) {\r\n          try {\r\n            filterResult = this._options.filter(transformedItem);\r\n            this._debug(\"processData\", \"filter item result\", transformedItem, filterResult);\r\n          } catch (err) {\r\n            this._debug(\"processData\", \"error calling filter\", err);\r\n            throw new Error(\"error in filter: \" + err.message);\r\n          }\r\n          if (filterResult) {\r\n            transformedFiltered.push(transformedItem);\r\n          }\r\n        } else {\r\n          transformedFiltered.push(transformedItem);\r\n        }\r\n      }\r\n      if (hasSort) {\r\n        try {\r\n          transformedFiltered.sort(this._options.sort);\r\n        } catch (err) {\r\n          this._debug(\"processData\", \"error calling sort\", err);\r\n          throw new Error(\"error in sort: \" + err.message);\r\n        }\r\n      }\r\n      if (hasLimit) {\r\n        limitDelta = transformedFiltered.length - this._options.limit;\r\n        this._debug(\"processData\", \"checking limit\", transformedFiltered.length, this._options.limit, limitDelta);\r\n        if (limitDelta > 0) {\r\n          unusedItems = transformedFiltered.slice(transformedFiltered.length - limitDelta);\r\n          this._debug(\"processData\", \"unusedItems\", unusedItems.length, unusedItems);\r\n          transformedFiltered.splice(transformedFiltered.length - limitDelta, limitDelta);\r\n        }\r\n      }\r\n      return {\r\n        items: transformedFiltered,\r\n        unused: unusedItems\r\n      };\r\n    };\r\n    Instafeed.prototype._extractTags = function extractTags(str) {\r\n      var exp = /#([^\\s]+)/gi;\r\n      var badChars = /[~`!@#$%^&*\\(\\)\\-+={}[\\]:;\"'<>?,./|\\\\\\s]+/i;\r\n      var tags = [];\r\n      var match = null;\r\n      if (typeof str === \"string\") {\r\n        while ((match = exp.exec(str)) !== null) {\r\n          if (badChars.test(match[1]) === false) {\r\n            tags.push(match[1]);\r\n          }\r\n        }\r\n      }\r\n      return tags;\r\n    };\r\n    Instafeed.prototype._getItemData = function getItemData(data) {\r\n      var type = null;\r\n      var image = null;\r\n      switch (data.media_type) {\r\n       case \"IMAGE\":\r\n        type = \"image\";\r\n        image = data.media_url;\r\n        break;\r\n  \r\n       case \"VIDEO\":\r\n        type = \"video\";\r\n        image = data.thumbnail_url;\r\n        break;\r\n  \r\n       case \"CAROUSEL_ALBUM\":\r\n        type = \"album\";\r\n        image = data.media_url;\r\n        break;\r\n      }\r\n      return {\r\n        caption: data.caption,\r\n        tags: this._extractTags(data.caption),\r\n        id: data.id,\r\n        image: image,\r\n        link: data.permalink,\r\n        model: data,\r\n        timestamp: data.timestamp,\r\n        type: type,\r\n        username: data.username\r\n      };\r\n    };\r\n    Instafeed.prototype._renderData = function renderData(items) {\r\n      var hasTemplate = typeof this._options.template === \"string\";\r\n      var hasRender = typeof this._options.render === \"function\";\r\n      var item = null;\r\n      var itemHtml = null;\r\n      var container = null;\r\n      var html = \"\";\r\n      this._debug(\"renderData\", \"hasTemplate\", hasTemplate, \"hasRender\", hasRender);\r\n      if (typeof items !== \"object\" || items.length <= 0) {\r\n        return;\r\n      }\r\n      for (var i = 0; i < items.length; i++) {\r\n        item = items[i];\r\n        if (hasRender) {\r\n          try {\r\n            itemHtml = this._options.render(item, this._options);\r\n            this._debug(\"renderData\", \"custom render result\", item, itemHtml);\r\n          } catch (err) {\r\n            this._debug(\"renderData\", \"error calling render\", err);\r\n            throw new Error(\"error in render: \" + err.message);\r\n          }\r\n        } else if (hasTemplate) {\r\n          itemHtml = this._basicRender(item);\r\n        }\r\n        if (itemHtml) {\r\n          html = html + itemHtml;\r\n        } else {\r\n          this._debug(\"renderData\", \"render item did not return any content\", item);\r\n        }\r\n      }\r\n      this._debug(\"renderData\", \"html content\", html);\r\n      container = document.createElement(\"div\");\r\n      container.innerHTML = html;\r\n      this._debug(\"renderData\", \"container\", container, container.childNodes.length, container.childNodes);\r\n      while (container.childNodes.length > 0) {\r\n        this._debug(\"renderData\", \"appending child\", container.childNodes[0]);\r\n        this._state.node.appendChild(container.childNodes[0]);\r\n      }\r\n    };\r\n    Instafeed.prototype._basicRender = function basicRender(data) {\r\n      var exp = new RegExp(this._options.templateBoundaries[0] + \"([\\\\s\\\\w.]+)\" + this._options.templateBoundaries[1], \"gm\");\r\n      var template = this._options.template;\r\n      var match = null;\r\n      var output = \"\";\r\n      var substr = null;\r\n      var lastIndex = 0;\r\n      var keyPath = null;\r\n      var keyPathValue = null;\r\n      while ((match = exp.exec(template)) !== null) {\r\n        keyPath = match[1];\r\n        substr = template.slice(lastIndex, match.index);\r\n        output = output + substr;\r\n        keyPathValue = this._valueForKeyPath(keyPath, data);\r\n        if (keyPathValue) {\r\n          output = output + keyPathValue.toString();\r\n        }\r\n        lastIndex = exp.lastIndex;\r\n      }\r\n      if (lastIndex < template.length) {\r\n        substr = template.slice(lastIndex, template.length);\r\n        output = output + substr;\r\n      }\r\n      return output;\r\n    };\r\n    Instafeed.prototype._valueForKeyPath = function valueForKeyPath(keyPath, data) {\r\n      var exp = /([\\w]+)/gm;\r\n      var match = null;\r\n      var key = null;\r\n      var lastValue = data;\r\n      while ((match = exp.exec(keyPath)) !== null) {\r\n        if (typeof lastValue !== \"object\") {\r\n          return null;\r\n        }\r\n        key = match[1];\r\n        lastValue = lastValue[key];\r\n      }\r\n      return lastValue;\r\n    };\r\n    Instafeed.prototype._fail = function fail(err) {\r\n      var didHook = this._runHook(\"error\", err);\r\n      if (!didHook && console && typeof console.error === \"function\") {\r\n        console.error(err);\r\n      }\r\n      this._state.running = false;\r\n    };\r\n    Instafeed.prototype._start = function start() {\r\n      this._state.running = true;\r\n      this._runHook(\"before\");\r\n    };\r\n    Instafeed.prototype._finish = function finish() {\r\n      this._runHook(\"after\");\r\n      this._state.running = false;\r\n    };\r\n    Instafeed.prototype._success = function success(data) {\r\n      this._runHook(\"success\", data);\r\n      this._state.running = false;\r\n    };\r\n    Instafeed.prototype._makeApiRequest = function makeApiRequest(url, callback) {\r\n      var called = false;\r\n      var scope = this;\r\n      var apiRequest = null;\r\n      var callbackOnce = function callbackOnce(err, value) {\r\n        if (!called) {\r\n          called = true;\r\n          callback(err, value);\r\n        }\r\n      };\r\n      apiRequest = new XMLHttpRequest();\r\n      apiRequest.ontimeout = function apiRequestTimedOut() {\r\n        callbackOnce(new Error(\"api request timed out\"));\r\n      };\r\n      apiRequest.onerror = function apiRequestOnError() {\r\n        callbackOnce(new Error(\"api connection error\"));\r\n      };\r\n      apiRequest.onload = function apiRequestOnLoad(event) {\r\n        var contentType = apiRequest.getResponseHeader(\"Content-Type\");\r\n        var responseJson = null;\r\n        scope._debug(\"apiRequestOnLoad\", \"loaded\", event);\r\n        scope._debug(\"apiRequestOnLoad\", \"response status\", apiRequest.status);\r\n        scope._debug(\"apiRequestOnLoad\", \"response content type\", contentType);\r\n        if (contentType.indexOf(\"application/json\") >= 0) {\r\n          try {\r\n            responseJson = JSON.parse(apiRequest.responseText);\r\n          } catch (err) {\r\n            scope._debug(\"apiRequestOnLoad\", \"json parsing error\", err, apiRequest.responseText);\r\n            callbackOnce(new Error(\"error parsing response json\"));\r\n            return;\r\n          }\r\n        }\r\n        if (apiRequest.status !== 200) {\r\n          if (responseJson && responseJson.error) {\r\n            callbackOnce(new Error(responseJson.error.code + \" \" + responseJson.error.message));\r\n          } else {\r\n            callbackOnce(new Error(\"status code \" + apiRequest.status));\r\n          }\r\n          return;\r\n        }\r\n        callbackOnce(null, responseJson);\r\n      };\r\n      apiRequest.open(\"GET\", url, true);\r\n      apiRequest.timeout = this._options.apiTimeout;\r\n      apiRequest.send();\r\n    };\r\n    Instafeed.prototype._getAccessToken = function getAccessToken(callback) {\r\n      var called = false;\r\n      var scope = this;\r\n      var timeoutCheck = null;\r\n      var callbackOnce = function callbackOnce(err, value) {\r\n        if (!called) {\r\n          called = true;\r\n          clearTimeout(timeoutCheck);\r\n          callback(err, value);\r\n        }\r\n      };\r\n      if (typeof this._options.accessToken === \"function\") {\r\n        this._debug(\"getAccessToken\", \"calling accessToken as function\");\r\n        timeoutCheck = setTimeout(function accessTokenTimeoutCheck() {\r\n          scope._debug(\"getAccessToken\", \"timeout check\", called);\r\n          callbackOnce(new Error(\"accessToken timed out\"), null);\r\n        }, this._options.accessTokenTimeout);\r\n        try {\r\n          this._options.accessToken(function accessTokenReceiver(err, value) {\r\n            scope._debug(\"getAccessToken\", \"received accessToken callback\", called, err, value);\r\n            callbackOnce(err, value);\r\n          });\r\n        } catch (err) {\r\n          this._debug(\"getAccessToken\", \"error invoking the accessToken as function\", err);\r\n          callbackOnce(err, null);\r\n        }\r\n      } else {\r\n        this._debug(\"getAccessToken\", \"treating accessToken as static\", typeof this._options.accessToken);\r\n        callbackOnce(null, this._options.accessToken);\r\n      }\r\n    };\r\n    Instafeed.prototype._debug = function debug() {\r\n      var args = null;\r\n      if (this._options.debug && console && typeof console.log === \"function\") {\r\n        args = [].slice.call(arguments);\r\n        args[0] = \"[Instafeed] [\" + args[0] + \"]\";\r\n        console.log.apply(null, args);\r\n      }\r\n    };\r\n    Instafeed.prototype._runHook = function runHook(hookName, data) {\r\n      var success = false;\r\n      if (typeof this._options[hookName] === \"function\") {\r\n        try {\r\n          this._options[hookName](data);\r\n          success = true;\r\n        } catch (err) {\r\n          this._debug(\"runHook\", \"error calling hook\", hookName, err);\r\n        }\r\n      }\r\n      return success;\r\n    };\r\n    return Instafeed;\r\n  });"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}